kind: secret
name: {{ .Release.Name }}-manticore-custom-ddl
description: User-provided custom DDL statements
tags: {{- include "manticore.tags" . | nindent 4 }}
type: opaque
data:
  encoding: plain
  payload: |-
    -- =============================================================================
    -- Custom DDL Statements
    -- =============================================================================
    -- This file contains user-provided SQL DDL statements that run after the
    -- standard table setup (plain index import, RT delta table, distributed table).
    --
    -- Use this to:
    --   - Create additional RT tables and add them to the cluster
    --   - Create additional distributed tables
    --   - Modify table settings
    --
    -- These statements are executed by replica-0 after cluster initialization.
    -- RT tables added to the cluster will replicate to all other nodes.
    -- =============================================================================

    {{- if .Values.manticore.customDDL }}
    {{ .Values.manticore.customDDL | nindent 4 }}
    {{- else }}
    -- No custom DDL defined in values.yaml
    -- To add custom DDL, set manticore.customDDL in your values file.
    --
    -- Example:
    --   manticore:
    --     customDDL: |
    --       CREATE TABLE IF NOT EXISTS my_rt_table (
    --           id BIGINT,
    --           content TEXT,
    --           created_at TIMESTAMP
    --       ) TYPE='rt';
    --       ALTER CLUSTER {{ .Values.manticore.clusterName }} ADD my_rt_table;
    {{- end }}
