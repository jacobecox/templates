kind: secret
name: {{.Release.Name}}-query-conf
description: Manticore query configuration
tags: {{- include "manticore.tags" . | nindent 4 }}
type: opaque
data:
  encoding: plain
  payload: |-
    searchd {
      listen          = 9306:mysql
      listen          = 9308:http
      log             = /dev/stdout
      query_log       = /dev/stdout
      pid_file        = /var/run/searchd.pid

      workers         = threads
      buddy_path =
      binlog_path     = /index/binlog
    }

    index addresses_main {
      path = /index/main/addresses_main/addresses_main
    }

    index addresses_delta {
      path = /index/delta/addresses_delta/addresses_delta
    }

    index addresses {
      type            = distributed
      local           = addresses_main
      local           = addresses_delta
    }