kind: secret
name: {{.Release.Name}}-manticore-conf
description: Manticore search configuration
tags: {{- include "manticore.tags" . | nindent 4 }}
type: opaque
data:
  encoding: plain
  payload: |-
    searchd {
      listen          = 9306:mysql
      listen          = 9308:http
      listen          = 9312:replication

      log             = /dev/stdout
      query_log       = /dev/stdout
      pid_file        = /var/run/searchd.pid

      workers         = threads
      binlog_path     = /var/lib/manticore/binlog

      seamless_rotate = 1
      preopen_indexes = 1
    }

    cluster {{ .Values.manticore.clusterName }} {
      node_timeout = 10s
      ha_strategy  = nofailover
    }