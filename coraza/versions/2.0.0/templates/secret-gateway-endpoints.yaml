kind: secret
name: {{ .Release.Name }}-gateway-endpoints
description: {{ .Release.Name }} API Gateway endpoints
tags: {{- include "coraza.tags" . | nindent 4 }}
type: dictionary
data:
  {{- range .Values.endpoints }}
  {{ .name }}: '    {      "api_id": "{{ .name }}",      "name": "{{ .name }}",      "org_id": "default",      "use_keyless": true,      "definition": {        "location": "header",        "key": "version"      },      "version_data": {        "not_versioned": true,        "versions": {          "Default": {            "name": "Default",            "use_extended_paths": true          }        }      },      "proxy": {        "listen_path": "{{ .path }}",        "target_url": "http://{{ .workload }}:{{ .port }}",        "strip_listen_path": true      },      "active": true    }'
  {{- end }}