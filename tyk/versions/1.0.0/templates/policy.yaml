---
kind: policy
name: {{ .Release.Name }}-tyk-api-gateway-policy
description: {{ .Release.Name }} Tyk API Gateway policy
tags: {{- include "tyk.tags" . | nindent 4 }}
bindings:
  - permissions:
      - reveal
    principalLinks:
      - //gvc/{{ .Values.global.cpln.gvc }}/identity/{{ .Release.Name }}-tyk-identity
targetKind: secret
targetLinks:
  - //secret/{{ .Release.Name }}-redis-auth-password
  - //secret/{{ .Release.Name }}-sentinel-auth-password
  - //secret/{{ .Release.Name }}-tyk-gateway-secret
{{- if .Values.apiSecretName }}
  - //secret/{{ .Values.apiSecretName }}
{{- end }}
{{- if .Values.policySecretName }}
  - //secret/{{ .Values.policySecretName }}
{{- end }}