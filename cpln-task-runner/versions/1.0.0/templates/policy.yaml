kind: policy
name: {{ .Release.Name }}-task-runner-policy
description: Task Runner policy
tags: {{- include "cpln-task-runner.tags" . | nindent 4 }}
bindings:
  - permissions:
      - reveal
    principalLinks:
      - //gvc/{{ .Values.global.cpln.gvc }}/identity/{{ .Release.Name }}-task-runner-identity
targetKind: secret
targetLinks:
{{- if .Values.createSecret }}
  - //secret/{{ .Values.secretName }}
{{- else }}
  - //secret/{{ .Values.redis.admin.fromSecret.name }}
  - //secret/{{ .Values.redis.redis.auth.fromSecret.name }}
  - //secret/{{ .Values.redis.sentinel.auth.fromSecret.name }}
{{- end }}