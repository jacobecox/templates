{{- if .Values.locations }}
{{- $current := . }}
kind: policy
name: {{ include "redis.policyName" $current }}
description: Redis Policy
tags: {{- include "redis.tags" $current | nindent 4 }}
bindings:
  - permissions:
      - reveal
    principalLinks:
    {{- range $current.Values.locations }}
      - //gvc/{{ $current.Release.Name }}-{{ . }}/identity/{{ include "redis.identityName" $current }}
    {{- end }}
targetKind: secret
targetLinks:
  - //secret/{{ include "redis.secretConfigName" $current }}
{{- else }}
{{- end }}